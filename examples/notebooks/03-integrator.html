
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Integrator &#8212; NengoFPGA 0.2.3.dev0 docs</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
 body .title-bar,
 body .documentation-source h1:after {
   background-color: #541a8b;
 }
</style>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>


<script src="../../_static/underscore.js"></script>


<script src="../../_static/doctools.js"></script>


<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>


<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());
         gtag('config', 'G-GT8XEDLTMJ');
        </script>
        <!-- End Google tag (gtag.js) -->
        <!-- Matomo -->
        <script>
         var _paq = window._paq = window._paq || [];
         _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
         _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
         _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.nengo.ai"]]);
         _paq.push(["enableCrossDomainLinking"]);
         _paq.push(["setDoNotTrack", true]);
         _paq.push(['trackPageView']);
         _paq.push(['enableLinkTracking']);
         (function() {
           var u="https://appliedbrainresearch.matomo.cloud/";
           _paq.push(['setTrackerUrl', u+'matomo.php']);
           _paq.push(['setSiteId', '3']);
           var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
           g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
         })();
        </script>
        <!-- End Matomo Code -->
    
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Simple Harmonic Oscillator" href="04-oscillator.html" />
    <link rel="prev" title="Set Neuron Parameters" href="02-set-neuron-params.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark"><!-- prettier-ignore -->


<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai/">
      <img src="https://www.nengo.ai/design/_images/general-full-light.svg" alt="Nengo" class="logo" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
      aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/">What is Nengo?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/examples/">Examples</a>
        </li>
        <li class="nav-item dropdown active">
          <a class="nav-link dropdown-toggle text-nowrap" id="navbar-dropdown-docs" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" href="#">Documentation</a>
          <div class="dropdown-menu shadow-lg border-0" aria-labelledby="navbar-dropdown-docs">
            
            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">NengoGUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">NengoDL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">NengoSPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">NengoExtras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <a class="dropdown-item" href="https://www.nengo.ai/keras-spiking">KerasSpiking</a>
            <a class="dropdown-item" href="https://www.nengo.ai/pytorch-spiking">PyTorchSpiking</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">NengoFPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">NengoLoihi</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-ocl/">NengoOCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">NengoSpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">NengoMPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation/">All documentation</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-nowrap" id="navbar-dropdown-community" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" href="#">Community</a>
          <div class="dropdown-menu shadow-lg border-0" aria-labelledby="navbar-dropdown-community">
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people/">People</a>
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school/">Summer school</a>
            <a class="dropdown-item" href="https://www.nengo.ai/contributing/">Contributing</a>
            <a class="dropdown-item" href="https://www.nengo.ai/publications/">Publications</a>
            <a class="dropdown-item" href="https://www.nengo.ai/videos/">Videos</a>
            <a class="dropdown-item" href="https://www.nengo.ai/conduct/">Code of conduct</a>
            <a class="dropdown-item" href="https://www.nengo.ai/caa/">CAA</a>
          </div>
        </li>
      </ul>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link btn btn-success btn-sm text-white" href="https://www.nengo.ai/getting-started/">Getting
            started</a>
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="../../index.html">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/nengo-fpga-full-light.svg"
        alt="NengoFPGA"
      />
    </a>
  </h3>
<form class="px-5 py-3 my-0 border-bottom" action="../../search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form><div class="p-5 toctree">
  
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../examples.html#notebook-examples">Notebook Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="00-communication-channel.html">Communication Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="01-learn-communication-channel.html">Learning a Communication Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="02-set-neuron-params.html">Set Neuron Parameters</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Integrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="04-oscillator.html">Simple Harmonic Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="05-controlled-oscillator.html">Controlled Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="06-chaotic-attractor.html">The Lorenz Chaotic Attractor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html#gui-examples">GUI Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project.html">Project Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project.html#contributing-to-nengofpga">Contributing to NengoFPGA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project.html#nengofpga-license">NengoFPGA license</a></li>
</ul>

  
  </div>
  
  <form class="p-5 my-0 border-top">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">
        
        
        <option selected>latest</option>
        
        
          
        <option value="../../v0.2.2/examples/notebooks/03-integrator.html">
          v0.2.2
        </option>
          
        
      </select>
    </div>
  </form>
  
</div>
      

      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source" role="main">
              
              
              <div class="admonition note">
                  <p class="admonition-title">Note</p>
                  <p>
                  This documentation is for a development version.
                  <a href="../../v0.2.2/examples/notebooks/03-integrator.html">
                  Click here for the latest stable release (v0.2.2).
                  </a>
                  </p>
              </div>
              
              
  <div class="section" id="Integrator">
<h1>Integrator<a class="headerlink" href="#Integrator" title="Permalink to this headline">¶</a></h1>
<p>This example implements a one-dimensional neural integrator using an on-chip recurrent connection on the FPGA. It shows how neurons can be used to implement stable dynamics. Such dynamics are important for memory, noise cleanup, statistical inference, and many other dynamic transformations.</p>
<p>In standard control theoretic form, the dynamics of a state vector can be described as:</p>
<div class="math notranslate nohighlight">
\[\dot{x}(t) = \mathbf{A}x(t) + \mathbf{B}u(t)\]</div>
<p>where <span class="math notranslate nohighlight">\(x(t)\)</span> is the state vector, <span class="math notranslate nohighlight">\(u(t)\)</span> is the time-varying input vector, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is the dynamics (feedback) matrix, and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> is the input matrix. For an integrator, <span class="math notranslate nohighlight">\(\mathbf{A} = 0\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B} = 1\)</span>.</p>
<p>By applying the dynamics principal of the NEF, for a neural network using exponential synapses (like the FpgaPesEnsembleNetwork network), the feedback and input matrices can be converted into their equivalent neural forms with:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    \mathbf{A}' &amp;= \tau\mathbf{A} + \mathbf{I}\\
    \mathbf{B}' &amp;= \tau\mathbf{B}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}'\)</span> is the neural feedback matrix, <span class="math notranslate nohighlight">\(\mathbf{B}'\)</span> is the neural input matrix, and <span class="math notranslate nohighlight">\(\tau\)</span> is the post-synaptic time constant of the feedback connection. For an integrator:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    \mathbf{A}' &amp;= \tau \times 0 + \mathbf{I} = \mathbf{I}\\
    \mathbf{B}' &amp;= \tau \times 1 = \tau
\end{align}\end{split}\]</div>
<p>This implies that the feedback transform should be an identity, and the input transform to the neural population should be scaled by <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<p>When you run this example, it will automatically put in some step functions on the input, so you can see that the output is integrating (i.e. summing over time) the input. You can also input your own values. Note that since the integrator constantly sums its input, it will saturate quickly if you leave the input non-zero. This makes it clear that neurons have a finite range of representation. Such saturation effects can be exploited to perform useful computations (e.g. soft normalization).</p>
<div class="section" id="Step-1:-Set-up-the-Python-Imports">
<h2>Step 1: Set up the Python Imports<a class="headerlink" href="#Step-1:-Set-up-the-Python-Imports" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">nengo</span>
<span class="kn">from</span> <span class="nn">nengo.processes</span> <span class="kn">import</span> <span class="n">Piecewise</span>

<span class="kn">import</span> <span class="nn">nengo_fpga</span>
<span class="kn">from</span> <span class="nn">nengo_fpga.networks</span> <span class="kn">import</span> <span class="n">FpgaPesEnsembleNetwork</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Step-2:-Choose-an-FPGA-Device">
<h2>Step 2: Choose an FPGA Device<a class="headerlink" href="#Step-2:-Choose-an-FPGA-Device" title="Permalink to this headline">¶</a></h2>
<p>Define the FPGA device on which the remote FpgaPesEnsembleNetwork will run. This name corresponds with the name in your <code class="docutils literal notranslate"><span class="pre">fpga_config</span></code> file. Recall that in the <code class="docutils literal notranslate"><span class="pre">fpga_config</span></code> file, device names are identified by the square brackets (e.g., <strong>[de1]</strong> or <strong>[pynq]</strong>). The names defined in your configuration file might differ from the example below. Here, the device <strong>de1</strong> is being used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">board</span> <span class="o">=</span> <span class="s2">&quot;de1&quot;</span>  <span class="c1"># Change this to your desired device name</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Step-3:-Create-an-Input-for-the-Model">
<h2>Step 3: Create an Input for the Model<a class="headerlink" href="#Step-3:-Create-an-Input-for-the-Model" title="Permalink to this headline">¶</a></h2>
<p>We will use a piecewise step function as input, so we can see the effects of recurrence.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Integrator&quot;</span><span class="p">)</span>
<span class="c1"># Create a piecewise step function for input</span>
<span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">input_node</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">Piecewise</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">0</span><span class="p">}))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Step-4:-Create-the-FPGA-Ensemble">
<h2>Step 4: Create the FPGA Ensemble<a class="headerlink" href="#Step-4:-Create-the-FPGA-Ensemble" title="Permalink to this headline">¶</a></h2>
<p>Create a remote FPGA neural ensemble (<code class="docutils literal notranslate"><span class="pre">FpgaPesEnsembleNetwork</span></code>) using the board defined above, 100 neurons, 1 dimensions, and with no learning rate. We will also specify the recurrent connection here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Synaptic time constant</span>

<span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="c1"># Remote FPGA neural ensemble</span>
    <span class="n">fpga_ens</span> <span class="o">=</span> <span class="n">FpgaPesEnsembleNetwork</span><span class="p">(</span>
        <span class="n">board</span><span class="p">,</span>  <span class="c1"># The board to use (from above)</span>
        <span class="n">n_neurons</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># The number of neurons to use in the ensemble</span>
        <span class="n">dimensions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># 1 dimensions</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># No learning for this example</span>
        <span class="n">feedback</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Activate the recurrent connection</span>
    <span class="p">)</span>

    <span class="c1"># Setting `feedback=1` creates a `feedback` connection object</span>
    <span class="c1"># with the identity transform. You can set the attributes on this</span>
    <span class="c1"># feedback connection object, such as `.function` and `.transform`</span>
    <span class="n">fpga_ens</span><span class="o">.</span><span class="n">feedback</span><span class="o">.</span><span class="n">synapse</span> <span class="o">=</span> <span class="n">tau</span>  <span class="c1"># `nengo.LowPass(tau)`</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Specified FPGA configuration &#39;de1&#39; not found.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WARNING: Specified FPGA configuration &#39;de1&#39; not found.
</pre></div></div>
</div>
</div>
<div class="section" id="Step-5:-Connect-Everything-Together">
<h2>Step 5: Connect Everything Together<a class="headerlink" href="#Step-5:-Connect-Everything-Together" title="Permalink to this headline">¶</a></h2>
<p>The recurrent connection is housed on the FPGA device and is created as part of the <code class="docutils literal notranslate"><span class="pre">FpgaPesEnsembleNetwork</span></code> object, so the only connection that needs to be made is the input stimulus to the FPGA ensemble.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="c1"># Connect the stimulus, with a scaling transform of tau</span>
    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">input_node</span><span class="p">,</span> <span class="n">fpga_ens</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Step-6:-Add-Probes-to-Collect-Data">
<h2>Step 6: Add Probes to Collect Data<a class="headerlink" href="#Step-6:-Add-Probes-to-Collect-Data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="c1"># The original input</span>
    <span class="n">input_p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">input_node</span><span class="p">)</span>

    <span class="c1"># The output from the FPGA ensemble</span>
    <span class="c1"># (filtered with a 10ms post-synaptic filter)</span>
    <span class="n">output_p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">fpga_ens</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Step-7:-Run-the-Model">
<h2>Step 7: Run the Model<a class="headerlink" href="#Step-7:-Run-the-Model" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">nengo_fpga</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Building network with dummy (non-FPGA) ensemble.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WARNING: Building network with dummy (non-FPGA) ensemble.
</pre></div></div>
</div>
</div>
<div class="section" id="Step-8:-Plot-the-Results">
<h2>Step 8: Plot the Results<a class="headerlink" href="#Step-8:-Plot-the-Results" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_results</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_p</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Input&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_p</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Integrator output&quot;</span><span class="p">)</span>
    <span class="n">plot_ideal</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_ideal</span><span class="p">():</span>
    <span class="c1"># Obtain the input function data from the input_node</span>
    <span class="n">input_t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_node</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">input_v</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_node</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="c1"># Construct the ideal output (assumes 1D signal)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">input_t</span> <span class="o">+=</span> <span class="p">[</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_v</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">input_t</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">input_t</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>

    <span class="c1"># Make the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">input_t</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ideal&quot;</span><span class="p">)</span>


<span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_notebooks_03-integrator_16_0.png" src="../../_images/examples_notebooks_03-integrator_16_0.png" />
</div>
</div>
<p>The plot above shows the neurons effectively integrating the input signal. Because of the implementation in neurons, the integration is not perfect (i.e., there will be some drift). Run the simulation several times to get a sense of the kinds of drift you might expect.</p>
</div>
<div class="section" id="Step-9:-Spiking-Neurons">
<h2>Step 9: Spiking Neurons<a class="headerlink" href="#Step-9:-Spiking-Neurons" title="Permalink to this headline">¶</a></h2>
<p>The plots above demonstrate the results of an integrator network implemented with non-spiking rectified linear neurons. The network can also be simulated using spiking neurons to illustrate the similarities and differences between a spiking and a non-spiking network.</p>
<p>Below, we configure the FPGA neural ensemble to use spiking neurons, run the simulation, and plot the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">fpga_ens</span><span class="o">.</span><span class="n">ensemble</span><span class="o">.</span><span class="n">neuron_type</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">SpikingRectifiedLinear</span><span class="p">()</span>

<span class="k">with</span> <span class="n">nengo_fpga</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Building network with dummy (non-FPGA) ensemble.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WARNING: Building network with dummy (non-FPGA) ensemble.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_notebooks_03-integrator_19_2.png" src="../../_images/examples_notebooks_03-integrator_19_2.png" />
</div>
</div>
<p>The plot above shows that while the output differs from the non-spiking simulation (because the network parameters are regenerated when a new simulation is created), the performance of the spiking integrator still conforms to the expected output of an integrator.</p>
</div>
<div class="section" id="Step-10:-Experiment!">
<h2>Step 10: Experiment!<a class="headerlink" href="#Step-10:-Experiment!" title="Permalink to this headline">¶</a></h2>
<p>Try playing around with the number of neurons in the FPGA ensemble as well as the synaptic time constant (<code class="docutils literal notranslate"><span class="pre">tau</span></code>) to see how it effects performance (e.g., observe how changing these numbers affect the drift)!</p>
</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom-center">
  <p class="text-center">
    <a class="no-hover-line" href="https://appliedbrainresearch.com">
      <img class="abr-logo" src="https://www.nengo.ai/img/abr-logo.svg" height="32" />
    </a>
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/examples/">Examples</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/getting-started/">Getting started</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center pb-0 mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>