<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Examples &#8212; NengoFPGA 0.2.2 docs</title>
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,600|Rajdhani:700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
  body .title-bar,
  body .documentation-source h1:after {
    background-color: #541a8b;
  }
</style>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-GT8XEDLTMJ');
</script>
<!-- End Google tag (gtag.js) -->

<!-- Matomo -->
<script>
 var _paq = window._paq = window._paq || [];
 _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
 _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
 _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.labs.nengo.ai","*.nengo.ai"]]);
 _paq.push(["enableCrossDomainLinking"]);
 _paq.push(["setDoNotTrack", true]);
 _paq.push(['trackPageView']);
 _paq.push(['enableLinkTracking']);
 (function() {
   var u="https://appliedbrainresearch.matomo.cloud/";
   _paq.push(['setTrackerUrl', u+'matomo.php']);
   _paq.push(['setSiteId', '3']);
   var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
   g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
 })();
</script>
<!-- End Matomo Code -->
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>


<script src="_static/underscore.js"></script>


<script src="_static/doctools.js"></script>


<script src="_static/language_data.js"></script>


<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>


<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>

    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Communication Channel" href="examples/notebooks/00-communication-channel.html" />
    <link rel="prev" title="Usage" href="usage.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark">

<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai/">
      <img
        src="https://www.nengo.ai/design/_images/general-full-light.svg"
        alt="Nengo"
        class="logo"
      />
    </a>
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbar-collapse"
      aria-controls="navbar-collapse"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/">What is Nengo?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/examples/">Examples</a>
        </li>
        <li class="nav-item dropdown active">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-docs"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Documentation</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-docs"
          >

            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo Core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">Nengo GUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">Nengo DL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">Nengo SPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">Nengo Extras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">Nengo FPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">Nengo Loihi</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-ocl">Nengo OpenCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">Nengo SpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">Nengo MPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation/"
              >All documentation</a
            >
          </div>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-community"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Community</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-community"
          >
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people/"
              >People</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school/"
              >Summer school</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/contributing/"
              >Contributing</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/publications/"
              >Publications</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/videos/"
              >Videos</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/conduct/"
              >Code of conduct</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/caa/">CAA</a>
          </div>
        </li>
        <li class="nav-item">
          <a
            class="nav-link btn btn-success btn-sm text-white"
            href="https://www.nengo.ai/getting-started/"
            >Getting started</a
          >
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="index.html">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/nengo-fpga-full-light.svg"
        alt="NengoFPGA"
      />
    </a>
  </h3>
<form class="px-5 py-3 my-0 border-bottom" action="search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form><div class="p-5 toctree">

    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#notebook-examples">Notebook Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/notebooks/00-communication-channel.html">Communication Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/notebooks/01-learn-communication-channel.html">Learning a Communication Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/notebooks/02-set-neuron-params.html">Set Neuron Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/notebooks/03-integrator.html">Integrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/notebooks/04-oscillator.html">Simple Harmonic Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/notebooks/05-controlled-oscillator.html">Controlled Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/notebooks/06-chaotic-attractor.html">The Lorenz Chaotic Attractor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gui-examples">GUI Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mnist-digit-classifier">MNIST Digit Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adaptive-pendulum-control">Adaptive Pendulum Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reinforcement-learning">Reinforcement Learning</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html#contributing-to-nengofpga">Contributing to NengoFPGA</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html#nengofpga-license">NengoFPGA license</a></li>
</ul>


  </div>

  <form class="p-5 my-0 border-top">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">


        <option value="../examples.html">latest</option>



        <option selected>v0.2.2</option>


      </select>
    </div>
  </form>

</div>


      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source" role="main">

  <div class="section" id="examples">
<span id="id1"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>NengoFPGA has a few examples to show you what’s possible and get you started.
There are some simple examples that are built with Jupyter
notebooks that illustrate the code with interspersed text information.
These notebook examples use the <a class="reference internal" href="usage.html#scripting"><span class="std std-ref">scripting</span></a> mode of
NengoFPGA without needing Nengo GUI.</p>
<p>There are also some more complex examples that are not built in notebooks
and instead use Nengo GUI. These examples are more complex and some have
opportunities for you to interact with the system via the GUI.</p>
<div class="section" id="notebook-examples">
<h2>Notebook Examples<a class="headerlink" href="#notebook-examples" title="Permalink to this headline">¶</a></h2>
<p>These example notebooks are statically rendered here for your perusal.
If you wish to experiment with these examples yourself, you can do so by
running the notebook from your own computer.
See <a class="reference internal" href="appendix.html#jupyter"><span class="std std-ref">Using Jupyter Notebooks</span></a> for help.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/notebooks/00-communication-channel.html">Communication Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/notebooks/01-learn-communication-channel.html">Learning a Communication Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/notebooks/02-set-neuron-params.html">Set Neuron Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/notebooks/03-integrator.html">Integrator</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/notebooks/04-oscillator.html">Simple Harmonic Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/notebooks/05-controlled-oscillator.html">Controlled Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/notebooks/06-chaotic-attractor.html">The Lorenz Chaotic Attractor</a></li>
</ul>
</div>
</div>
<div class="section" id="gui-examples">
<h2>GUI Examples<a class="headerlink" href="#gui-examples" title="Permalink to this headline">¶</a></h2>
<p>These examples are designed to be used with Nengo GUI, so it will have to be
installed. This can be done by running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">nengo-gui</span></code> from your
command line.</p>
<ol class="compact arabic simple">
<li><p>Install the GUI:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install nengo-gui
</pre></div>
</div>
</li>
<li><p>In a terminal, navigate to the <code class="docutils literal notranslate"><span class="pre">nengo_fpga/docs/examples/gui</span></code> directory.</p></li>
<li><p>Run one of the examples by running the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nengo &lt;file name&gt; -b nengo_fpga
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;file</span> <span class="pre">name&gt;</span></code> is the filename of the example. The <code class="docutils literal notranslate"><span class="pre">-b</span> <span class="pre">nengo_fpga</span></code>
indicates to the GUI to use the NengoFPGA backend (<code class="docutils literal notranslate"><span class="pre">nengo_fpga</span></code>) instead
of standard Nengo backend.</p>
<p>Successfully running the <code class="docutils literal notranslate"><span class="pre">nengo</span></code> command will open the Nengo GUI
interface in a web browser. On the right, you will see the code for the
example Nengo model, and on the left is a graphical representation of the
Nengo model.</p>
</li>
<li><p>In the code for each example, somewhere near the top of the file, you
should see a code block like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------- BOARD SELECT ----------------------- #</span>
<span class="c1"># Change this to your desired device name</span>
<span class="n">board</span> <span class="o">=</span> <span class="s1">&#39;de1&#39;</span>
<span class="c1"># ---------------- BOARD SELECT ----------------------- #</span>
</pre></div>
</div>
<p>To run the code with your system configuration, change the value of the
<code class="docutils literal notranslate"><span class="pre">board</span></code> variable to the desired board defined in the <code class="docutils literal notranslate"><span class="pre">fpga_config</span></code> file
(i.e., the board names defined in the <code class="docutils literal notranslate"><span class="pre">fpga_config</span></code> file). Refer to the
<a class="reference internal" href="getting-started.html#nengofpga-config"><span class="std std-ref">NengoFPGA configuration file</span></a> section
for help on how to properly set up the <code class="docutils literal notranslate"><span class="pre">fpga_config</span></code> file.</p>
</li>
<li><p>To start the simulation of the neural model, click the play button in the
bottom right of the window. Note that it may take several seconds for the
model to build and start running.</p></li>
</ol>
<div class="section" id="mnist-digit-classifier">
<h3>MNIST Digit Classifier<a class="headerlink" href="#mnist-digit-classifier" title="Permalink to this headline">¶</a></h3>
<p>This is an example of a one-layer vision network that is trained to classify
scaled down versions of the handwritten digits from the MNIST dataset. The
model takes as input the MNIST image, and produces as output the classification
confidence for each one of the 10 (zero through nine) possible number classes.</p>
<p>This example has some additional requirements, be sure you have the following
required packages installed:</p>
<ol class="arabic simple">
<li><p>Nengo Extras: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">nengo_extras</span></code></p></li>
<li><p>Python image library: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pillow</span></code></p></li>
</ol>
<p>To run this example in Nengo, from the <code class="docutils literal notranslate"><span class="pre">nengo_fpga/docs/examples/gui</span></code> directory, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nengo 00-mnist-vision-network.py -b nengo_fpga
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On the first run of the MNIST example, the python code downloads the MNIST
data set from <a class="reference external" href="http://deeplearning.net/data/mnist/mnist.pkl.gz">http://deeplearning.net/data/mnist/mnist.pkl.gz</a> into the
<code class="docutils literal notranslate"><span class="pre">nengo_fpga/docs/examples/gui</span></code> directory. The data set is approximately 16MB in size and may
take a while to download (depending on the speed of your internet
connection). Please do not interrupt the script while the download is
occurring.</p>
<p>If the download is interrupted, and the downloaded data set file
(<code class="docutils literal notranslate"><span class="pre">mnist.pkl.gz</span></code>) is corrupted, simply delete the <code class="docutils literal notranslate"><span class="pre">mnist.pkl.gz</span></code> file
from the <code class="docutils literal notranslate"><span class="pre">nengo_fpga/docs/examples/gui</span></code> directory and re-run the script. You may also download
the data set directly from the link above and place it in the <code class="docutils literal notranslate"><span class="pre">nengo_fpga/docs/examples/gui</span></code>
directory.</p>
</div>
<p>When the model is loaded into Nengo GUI, you should see a graphical
representation similar to the image below.</p>
<a class="reference internal image-reference" href="_images/mnist_gui.png"><img alt="MNIST Example GUI" src="_images/mnist_gui.png" style="width: 100%;" /></a>
<p>In the top half of the graphical pane, you should see the high-level
representation of the MNIST network. The bottom half of the graphical pane
is divided into three sections:</p>
<ul class="simple">
<li><p>The digit being presented to the network is shown on the left.</p></li>
<li><p>A visual representation (<code class="docutils literal notranslate"><span class="pre">output_spa</span></code>) of the output classification of the
network. The size of the text corresponds to the model’s confidence in the
output classification.</p></li>
<li><p>The numerical representation of the <code class="docutils literal notranslate"><span class="pre">output_spa</span></code> graphic is shown on the
right. This graph shows the model’s confidence of each number class as they
relate to each other. The higher the graph line, the more confidence the
model has in that one particular number class.</p></li>
</ul>
<p>When the simulation is run, you should see an output like the image below.</p>
<a class="reference internal image-reference" href="_images/mnist.gif"><img alt="MNIST Simulation" class="align-center" src="_images/mnist.gif" style="width: 75%;" /></a>
</div>
<div class="section" id="adaptive-pendulum-control">
<h3>Adaptive Pendulum Control<a class="headerlink" href="#adaptive-pendulum-control" title="Permalink to this headline">¶</a></h3>
<p>This example demonstrates the use of an adaptive controller to control a
weighted inverted pendulum that is affected by gravity. The controller used is
the combination of a standard Proportional-Derivative (PD) controller with an
adaptive neural ensemble. Together, these two components implement a
Proportional-Integral-Derivative (PID) controller, where the integral
term is adaptive and compensates for changing steady state error as gravity
acts on the system.</p>
<p>To run this example in Nengo, from the <code class="docutils literal notranslate"><span class="pre">nengo_fpga/docs/examples/gui</span></code> directory, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nengo 01-adaptive-pendulum.py -b nengo_fpga
</pre></div>
</div>
<p>When the model is loaded into Nengo GUI, you should see a graphical
representation similar to the image below.</p>
<a class="reference internal image-reference" href="_images/pendulum_gui.png"><img alt="Inverted Pendulum Example GUI" src="_images/pendulum_gui.png" style="width: 100%;" /></a>
<p>In the top half of the graphical pane, you should see the high-level
representation of the MNIST network. The bottom half of the graphical pane
is divided into two sections:</p>
<ul class="compact simple">
<li><p>Two sliders on the left:</p>
<ul>
<li><p><strong>Target Pendulum Angle</strong> is the desired angle of the pendulum. The
angle is defined as the amount of radians from the vertical (positive
radians to the right, negative radians to the left). By default, this
slider is set to automatically oscillate between 1 and -1 radians, but
you are able to manually move it if desired.</p></li>
<li><p><strong>Extra Mass</strong> controls the amount of additional mass added to the
pendulum. The mass is defined in units of kg, and the pendulum starts with
a mass of 1kg.</p></li>
</ul>
</li>
<li><p>The pendulum visualization on the right:</p>
<ul>
<li><p>The blue line represents the target, or desired position of the
pendulum.</p></li>
<li><p>The black line is the representation of the actual position of the
pendulum that is being controlled by the adaptive PID controller.</p></li>
</ul>
</li>
</ul>
<p>When the simulation is running, you should see the pendulum like the one in
the image on the left below. Observe that as the simulation progresses,
the actual position of the pendulum converges to that of the target angle.
As a comparison, the image on the right below show the same pendulum
controlled by a standard PD controller. It can be seen that in this case,
the actual position of the pendulum never converges to the desired target
angle.</p>
<table class="colwidths-given docutils align-center">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="Inverted Pendulum Simulation" src="_images/pendulum.gif" />
<p>        Adaptive Controller</p>
</td>
<td><img alt="Inverted Pendulum Adaptive Simulation" src="_images/pendulum_no-learn.gif" />
<p>    Non-adaptive Controller</p>
</td>
</tr>
</tbody>
</table>
<p>You can also try moving the <strong>Extra Mass</strong> slider up or down in the GUI and
observe how the added or reduced mass affect the position of the pendulum,
especially as it approaches the horizontal position where the torque due to
gravity is at its peak.</p>
</div>
<div class="section" id="reinforcement-learning">
<h3>Reinforcement Learning<a class="headerlink" href="#reinforcement-learning" title="Permalink to this headline">¶</a></h3>
<p>This example demonstrates how an adaptive FPGA ensemble can be used to
implement an agent capable of reinforcement learning. The agent can perform
three actions (go forward, rotate clockwise, rotate counter-clockwise), and
has a 5-point “radar” that provides it the distance to any obstacles directly
ahead, directly to its sides, and on the forward diagonals.</p>
<p>The agent is controlled by a basal ganglia (BG) action selection system that
determines which of the three actions the agent is to perform, based on the
input utility values to the basal ganglia.</p>
<p>The radar data is fed into the adaptive FPGA ensemble to compute the BG
utility values. When the simulation starts, the BG utility values start at
0.8 for moving forward, and 0.7 and 0.6 for rotating counter-clockwise and
clockwise respectively. Thus, if the utility values are not modified,
the agent should be biased to move in a forward direction.</p>
<p>A reward system is set up to give a positive value when moving forward, and
no reward if the agent is stationary or has crashed into a wall.  In theory,
this should cause it to learn to avoid obstacles.  In particular, it will
start to turn before it hits the obstacle, as a continual forward movement
(albeit at an angle) will provide it with a higher reward.</p>
<p>From the reward system, an error signal is computed. The error signal in this
case is very simple: the difference between the computed utility and the
instantaneous reward.  This error signal should only be applied to whatever
action is currently being chosen (although it isn’t quite perfect at doing
this).  Note that this means it <em>cannot</em> learn to do actions that will lead to
<em>future</em> rewards.</p>
<p>The error signal is fed into the adaptive FPGA ensemble to modulate it’s,
which in turn modifies the mapping between the different radar states and the
learned action. In this way, the agent learns to associate specific radar
states with the action that will provide it the highest reward (and hopefully
avoid the walls).</p>
<p>To run this example in Nengo, from the <code class="docutils literal notranslate"><span class="pre">nengo_fpga/docs/examples/gui</span></code> directory, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nengo 02-RL-demo.py -b nengo_fpga
</pre></div>
</div>
<p>When the model is loaded into Nengo GUI, you should see a graphical
representation similar to the image below.</p>
<a class="reference internal image-reference" href="_images/rl_gui.png"><img alt="RL Example GUI" src="_images/rl_gui.png" style="width: 100%;" /></a>
<p>For this example, the graphical pane is divided into four quadrants.</p>
<ul class="simple">
<li><p>In the top left quadrant, the network diagram for this example is displayed.</p></li>
<li><p>In the bottom left quadrant, the values for the radar (<code class="docutils literal notranslate"><span class="pre">stim_radar</span></code>) and
the reward values associated with the agent’s current action (<code class="docutils literal notranslate"><span class="pre">reward</span></code>) are
shown.</p></li>
<li><p>A graphical representation of the world map, and the agent’s current location
in this map is displayed in the top right quadrant. The agent is represented
as a blue triangle, and the obstacles in the world with black squares. When
the agent encounters an obstacle, it changes from a blue to a red colour.
Also indicated is the current “learning” state of the agent – the agent
is learning when <strong>Explore</strong> is <strong>ON</strong>, and conversely, is not adapting to
the reward signals when <strong>Explore</strong> is <strong>OFF</strong>. If the <code class="docutils literal notranslate"><span class="pre">keyboard-state</span></code>
branch of the Nengo GUI is being used, the learning mode of the agent can
be controlled using keyboard presses (see <a class="reference internal" href="#keyboard-state"><span class="std std-ref">below</span></a>).</p></li>
<li><p>The bottom right quadrant displays the output of the action selection network
(<code class="docutils literal notranslate"><span class="pre">Thalamus</span></code>), as well as the associated spike rasters for each action:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">actions_0</span></code>: Move forward</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actions_1</span></code>: Turn counter-clockwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actions_2</span></code>: Turn clockwise</p></li>
</ul>
</li>
</ul>
<p>When the simulation is running, the agent should move around the world, as
shown in the images below. The images below also show the agent moving around
the world in 3 modes:</p>
<ol class="arabic simple">
<li><p>Exploring: The agent is constantly using the error signal to learn
which is the best action to perform.</p></li>
<li><p>Exploiting: The learning has been disabled after the agent has spent
about 15 seconds in the “Exploring” mode. The agent is thus moving
about the world using the radar-to-action mapping it had learned in the
exploration phase.</p></li>
<li><p>No Learning: The simulation is started with learning disabled. In this
scenario, the agent moves forward, encounters a wall, and is unable to
recover.</p></li>
</ol>
<table class="colwidths-given docutils align-center">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/rl_explore.gif" src="_images/rl_explore.gif" />
<p>      Exploring</p>
</td>
<td><img alt="_images/rl_exploit.gif" src="_images/rl_exploit.gif" />
<p>      Exploiting</p>
</td>
<td><img alt="_images/rl_no-learn.gif" src="_images/rl_no-learn.gif" />
<p>      No Learning</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="changing-the-world-layout">
<h4>Changing the world layout<a class="headerlink" href="#changing-the-world-layout" title="Permalink to this headline">¶</a></h4>
<p>Near the top of the file, a section of code defines the layout of the world
the agent is exploring. The section of code looks something like:</p>
<div class="compact highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">world_maps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">#########</span>
<span class="s2">#       #</span>
<span class="s2">#       #</span>
<span class="s2">#   ##  #</span>
<span class="s2">#   ##  #</span>
<span class="s2">#       #</span>
<span class="s2">#########&quot;&quot;&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>You can alter the default world map by changing the first entry in the
<code class="docutils literal notranslate"><span class="pre">world_maps</span></code> list. Obstacles are indicated with the <code class="docutils literal notranslate"><span class="pre">#</span></code> character, and
unobstructed space is indicated with the space character. The world map can
be increased or decreased in size by altering the number of rows and columns
that make up the map.</p>
</div>
<div class="section" id="controlling-the-simulation-with-the-keyboard">
<span id="keyboard-state"></span><h4>Controlling the simulation with the keyboard<a class="headerlink" href="#controlling-the-simulation-with-the-keyboard" title="Permalink to this headline">¶</a></h4>
<p>You should see instructions printed in the console pane on the bottom right.
These instructions will inform you on which keyboard presses can be used to
disable or permanently enable learning; reset the agent’s location back to the
start location; and change the world map.</p>
<p>If you do not see instructions for key presses then this feature is currently
not available with your installed version of Nengo GUI.</p>
</div>
</div>
</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom">
  <p class="small text-center mb-0">
    <a class="no-hover-line" href="https://appliedbrainresearch.com">
      <img
        src="https://appliedbrainresearch.com/img/logo-blue-notext.svg"
        height="48"
      />
    </a>
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/examples/">Examples</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/getting-started/">Getting started</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>
